config:
    name: 教师H5_职工考勤
    variables:
        Protocol: ${ENV(Protocol)}
        host: ${ENV(HOST)}
        domainName: ${ENV(DONAIN_NAME)}
    parameters:
        username-password: ${P(data/accounts.csv)}
        validnum: [ '1','2','3','4','5','6','8','9' ]
    verify: false
teststeps:
-   name: 教师H5_登陆
    request:
        data:
            systemCode: h5garden
            username: $username
            password: $password
        headers:
            Accept: application/json, text/plain, */*
            Accept-Encoding: gzip, deflate
            Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
            Connection: keep-alive
            Content-Length: '78'
            Content-Type: application/x-www-form-urlencoded;charset=UTF-8
            Host: $host
            Origin: $Protocol://$host
            Referer: $Protocol://$host/school/m/
            User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15
                (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1
            X-Requested-With: XMLHttpRequest
            domainName: $domainName
        method: POST
        url: $Protocol://$host/v1/web/eduaccount/sys/login
    extract:
        token: body.data.token
    validate:
    -   eq:
        - status_code
        - 200
    -   eq:
        - headers.Content-Type
        - application/json;charset=UTF-8
    -   eq:
        - body.code
        - 0
-   name: 应用-列表收藏应用（账号收藏的应用）
    request:
        headers:
            Accept: application/json, text/plain, */*
            Accept-Encoding: gzip, deflate
            Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
            Connection: keep-alive
            Content-Type: application/json;charset=utf-8
            Host: $host
            Referer: $Protocol://$host/school/m/
            User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15
                (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1
            X-Access-Token: $token
            X-Requested-With: XMLHttpRequest
            domainName: $domainName
        method: GET
        params:
            platform: '2'
        url: $Protocol://$host/v1/web/edudistrict/apps/personal
    validate:
    -   eq:
        - status_code
        - 200
    -   eq:
        - headers.Content-Type
        - application/json;charset=UTF-8
    -   eq:
        - body.code
        - 0
-   name: 登录相关-获取身份列表(H5)
    request:
        headers:
            Accept: application/json, text/plain, */*
            Accept-Encoding: gzip, deflate
            Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
            Connection: keep-alive
            Content-Type: application/json;charset=utf-8
            Host: $host
            Referer: $Protocol://$host/school/m/
            User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15
                (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1
            X-Access-Token: $token
            X-Requested-With: XMLHttpRequest
            domainName: $domainName
        method: GET
        params:
            showMsgCount: '1'
            systemCode: h5garden
        url: $Protocol://$host/v1/web/eduaccount/user/h5/identitys
    validate:
    -   eq:
        - status_code
        - 200
    -   eq:
        - headers.Content-Type
        - application/json;charset=UTF-8
    -   eq:
        - body.code
        - 0
-   name: 考勤统计-月度数据列表
    request:
        headers:
            Accept: application/json, text/plain, */*
            Accept-Encoding: gzip, deflate
            Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
            Connection: keep-alive
            Content-Type: application/json;charset=utf-8
            Host: $host
            Referer: $Protocol://$host/school/m/
            User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15
                (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1
            X-Access-Token: $token
            X-Requested-With: XMLHttpRequest
            domainName: $domainName
        method: GET
        params:
            endTime: ${get_date()}
            startTime: ${get_date(-12)}
            systemCode: H5
        url: $Protocol://$host/v1/web/edugarden/attendance/statistics/monthDataList
    validate:
    -   eq:
        - status_code
        - 200
    -   eq:
        - headers.Content-Type
        - application/json;charset=UTF-8
    -   eq:
        - body.code
        - 0
-   name: 考勤统计-日考勤详情
    request:
        headers:
            Accept: application/json, text/plain, */*
            Accept-Encoding: gzip, deflate
            Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
            Connection: keep-alive
            Content-Type: application/json;charset=utf-8
            Host: $host
            Referer: $Protocol://$host/school/m/
            User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15
                (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1
            X-Access-Token: $token
            X-Requested-With: XMLHttpRequest
            domainName: $domainName
        method: GET
        params:
            endTime: ${get_date()}
            startTime: ${get_date()}
            systemCode: H5
        url: $Protocol://$host/v1/web/edugarden/attendance/statistics/attendanceDayItem
    validate:
    -   eq:
        - status_code
        - 200
    -   eq:
        - headers.Content-Type
        - application/json;charset=UTF-8
    -   eq:
        - body.code
        - 0
-   name: 考勤统计-有数据得月份
    request:
        headers:
            Accept: application/json, text/plain, */*
            Accept-Encoding: gzip, deflate
            Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
            Connection: keep-alive
            Content-Type: application/json;charset=utf-8
            Host: $host
            Referer: $Protocol://$host/school/m/
            User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15
                (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1
            X-Access-Token: $token
            X-Requested-With: XMLHttpRequest
            domainName: $domainName
        method: GET
        params:
            systemCode: H5
            year: '2021'
        url: $Protocol://$host/v1/web/edugarden/attendance/statistics/getAttendanceYearItem
    validate:
    -   eq:
        - status_code
        - 200
    -   eq:
        - headers.Content-Type
        - application/json;charset=UTF-8
    -   eq:
        - body.code
        - 0
-   name: 考勤统计-人员考勤月汇总
    request:
        headers:
            Accept: application/json, text/plain, */*
            Accept-Encoding: gzip, deflate
            Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
            Connection: keep-alive
            Content-Type: application/json;charset=utf-8
            Host: $host
            Referer: $Protocol://$host/school/m/
            User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15
                (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1
            X-Access-Token: $token
            X-Requested-With: XMLHttpRequest
            domainName: $domainName
        method: GET
        params:
            endTime: ${get_date()}
            startTime: ${get_date(-12)}
            systemCode: H5
            valid: $validnum
        url: $Protocol://$host/v1/web/edugarden/attendance/statistics/attendanceMonthItem
    validate:
    -   eq:
        - status_code
        - 200
    -   eq:
        - headers.Content-Type
        - application/json;charset=UTF-8
    -   eq:
        - body.code
        - 0